<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="../template.xhtml" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:b="http://bootsfaces.net/ui"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://xmlns.jcp.org/jsf/passthrough">
    <script src="https://smartlock.google.com/client"></script>
    <h:outputStylesheet library="css" name="default.css"  />
    
    <ui:define name="content"> 
        <f:metadata>
            <f:viewParam name="email" value="#{userbean.tmp.email}"/>
            <f:viewAction action="#{userbean.setUser()}"/>
        </f:metadata>

        <b:row>
            <h2>ADD RECIPE</h2>
        </b:row>
        <b:row>
            <b:column>
            <h2>Add Recipe</h2>
            
            </b:column>
        </b:row>            
        
        
        <b:row>
            
            <b:column span="6" >
                <b:row>
                    <b:form id="recipe">
                        <b:inputText id="test" value="#{userbean.tmp.email}" style="display:none;" />
                        <b:inputText id="test2" value="#{recipebean.useremail}" style="display:none;"/>
                        <b:inputText id="name" value="#{recipebean.tmp.name}" required="true"
                                         placeholder="Recipe name" />
                        <b:inputTextarea id="instructions" value="#{recipebean.tmp.instructions}" required="true"
                                             placeholder="Put in some instructions..." />
                        <p>Confirm Name and Instructions before adding ingredients: </p>
                        <b:commandButton onclick="testing()"  action="#{recipebean.add()}" value="Confirm Name and Instructions" />
                    </b:form>  
                </b:row>
                
                <b:row>
                    <b:messages/>
                </b:row>

                <b:form id="ingrForm">    

                    <h4>Ingredients:</h4>
                    <b:formGroup id="ing0">
                        <p>Add one ingredient at a time, and add more by using the form several times: </p>
                        <b:inputText id="ing0q" value="#{ribean.tmp.quantity}" type="number" span="3" placeholder="1"/>
                        <b:selectOneMenu id="ing0i" span='5' value="#{ribean.ingredientname}">
                            <f:selectItems value="#{ingredientbean.findAllArray()}" var="i"
                                            itemLabel="#{i.name}" itemValue="#{i.name}" />
                        </b:selectOneMenu>
                        <b:inputText id="ritest" value="#{recipebean.tmp.id}" style="display:none;" />
                        <b:inputText id="ritest2" value="#{ribean.recipeid}" style="display:none;"/>
                        <b:commandButton id="ing0b" onclick="fixRecIngr()" action="#{ribean.add()}" value="Add ingredient"/>
                        <br/>
                    </b:formGroup>
                    <b:commandButton id="lastbtn" value="Finish Recipe"
                                     action="#{recipebean.cancel()}"/>
                    <br/>
                    <br/>
                            
                </b:form>

            </b:column> 
        </b:row>

            <script>
                
                function newIng(n){
                    
                    var lastbutton = document.getElementById("ingrForm:lastbtn")
                    var x = document.getElementById("ingrForm:ing"+n).cloneNode(true)
                    document.getElementById("ingrForm").insertBefore(x, lastbutton)
                    
                }
                
                function fixRecIngr() {
                    document.getElementById("input_ingrForm:ritest2").value = document.getElementById("input_ingrForm:ritest").value;
                    console.log(document.getElementById("input_ingrForm:ritest2").value);
                }
                
                function testing () {
                    document.getElementById("input_recipe:test2").value = document.getElementById("input_recipe:test").value;
                }
                
            </script>
        
    </ui:define>
        
</ui:composition>

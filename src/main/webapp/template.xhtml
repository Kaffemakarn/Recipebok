<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <script src="https://smartlock.google.com/client"></script>
    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <title>BootsFaces Basic Page</title>
        <script src="https://www.gstatic.com/firebasejs/4.10.1/firebase.js"></script>
        <script>
        // Initialize Firebase
            var config = {
                apiKey: "AIzaSyBqpKfLJRB4qlk5jWNYN3YgIaa8obYWjMY",
                authDomain: "recipebok.firebaseapp.com",
                databaseURL: "https://recipebok.firebaseio.com",
                projectId: "recipebok",
                storageBucket: "recipebok.appspot.com",
                messagingSenderId: "287255300496",
                clientId : "287255300496-iktt97r9vie0imuvq3a31n3gh7bmmhha.apps.googleusercontent.com",

                scopes: [
                       "email",
                       "profile"
              ]
            };
            firebase.initializeApp(config);

        </script>
        <script>
            
            function logout(){
                firebase.auth().signOut();
                console.log("Trying to log out");
                window.location.href = "#{request.contextPath}/";
            }
        </script>
        
    </h:head>
    <h:body>
        
        <c:set var="root" value="#{request.contextPath}" /> 
        
            <b:navBar brand="Recipebook" brandHref="${root}/index.xhtml" fixed="top" inverse="true">
                <b:navbarLinks>
                    <b:navLink id="indexNav" value="Home"></b:navLink>
                    <b:navLink id="addRecipeNav" value="Add Recipe"></b:navLink>
                    <b:navLink id="profileNav" value="My Cookbooks"></b:navLink>
                </b:navbarLinks>
            </b:navBar>

        <b:container>
            <ui:insert name="content"/>
            <button id="user_div_button" onclick="logout()">Logout</button>
        </b:container>
        <script>
            firebase.auth().onAuthStateChanged(function(user) {
                
                var user = firebase.auth().currentUser;
                var user_email = user.email.toString();
                
                document.getElementById("indexNav").onclick = function () {
                    location.href = "${root}/index.xhtml?email=" + user_email;
                };
                
                document.getElementById("addRecipeNav").onclick = function () {
                    location.href = "${root}/recipe/addRecipe.xhtml?email=" + user_email;
                };
                
                document.getElementById("profileNav").onclick = function () {
                    location.href = "${root}/user/profile.xhtml?email=" + user_email;
                };
                
            });
           
        </script>
    </h:body>
</html>
